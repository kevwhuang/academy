<!DOCTYPE html>

<head>
    <title>JavaScript: ACA</title>

    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="author" content="Kevin Huang">
    <meta name="robots" content="index, follow">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>

<body>
</body>

<script>
    const C = console.table;
    const c = console.log;
    const h = e => c(`%c***** ${e}`, 'color:crimson;font-size:1pc;');
</script>

<script>
    h('GLOBAL METHODS');
    const chars = '#$&+,/:;=?@';
    var T = [];

    T.push({ method: 'parseInt()', return: parseInt(1.6, 10) });
    T.push({ method: 'parseInt()', return: parseInt(' 0a1 ') });
    T.push({ method: 'parseInt()', return: parseInt(' a00 ') });
    T.push({ method: 'parseFloat()', return: parseFloat('1.2') });

    T.push({ method: 'isFinite()', return: isFinite(Infinity) });
    T.push({ method: 'isNaN()', return: isNaN('a') });
    T.push({ method: 'eval()', return: eval('\'eval()\'') });

    T.push({ method: 'encodeURI()', return: encodeURI(chars) });
    T.push({ method: 'decodeURI()', return: decodeURI(encodeURIComponent(chars)) });
    T.push({ method: 'encodeURIComponent()', return: encodeURIComponent(chars) });
    T.push({ method: 'decodeURIComponent()', return: decodeURIComponent(chars) });

    C(T);
</script>

<script>
    h('NUMBER METHODS');
    const N = 1_234_567_890;
    const options = { style: 'currency', currency: 'EUR' };
    const optionsAll = { ...options, currencyDisplay: 'name', minimumFractionDigits: 5 };
    var T = [];

    T.push({ method: '.valueOf()', return: (new Number(123.40)).valueOf() });
    T.push({ method: '.toString()', return: N.toString(10) });
    T.push({ method: '.toLocaleString()', return: N.toLocaleString('en-GB', optionsAll) });
    T.push({ method: '.toExponential()', return: N.toExponential(5) });
    T.push({ method: '.toFixed()', return: N.toFixed(5) });
    T.push({ method: '.toPrecision()', return: N.toPrecision(20) });

    T.push({ method: 'Number()', return: Number(true) });
    T.push({ method: 'Number()', return: Number(' 0 ') });
    T.push({ method: 'Number()', return: Number(' a ') });
    T.push({ method: 'Number()', return: Number(new Date('2000')) });
    T.push({ method: 'Number.isInteger()', return: Number.isInteger(-0.1) });
    T.push({ method: 'Number.isSafeInteger()', return: Number.isSafeInteger(-(2 ** 53 - 1)) });

    C(T);
</script>

<script>
    h('STRING METHODS');
    const S = 'abcdefgAbc';
    const S0 = ' abc ';
    const optionsString = { sensitivity: 'base' };
    var T = [];

    T.push({ method: '.length', return: S.length });
    T.push({ method: '.slice()', return: S.slice(2, -2) });
    T.push({ method: '.substring()', return: S.substring(-99, 99) });
    T.push({ method: '.substr()', return: S.substr(-2, 2) });

    T.push({ method: '.includes()', return: S.includes('A', 0) });
    T.push({ method: '.startsWith()', return: S.startsWith('A', 0) });
    T.push({ method: '.endsWith()', return: S.endsWith('c', 3) });

    T.push({ method: '.indexOf()', return: S.indexOf('A', -1) });
    T.push({ method: '.lastIndexOf()', return: S.lastIndexOf('A', 10) });
    T.push({ method: '.search()', return: S.search(/b/) });

    T.push({ method: '.match()', return: S.match(/b/) });
    T.push({ method: '.matchAll()', return: S.matchAll(/b/g) });
    T.push({ method: '.replace()', return: S.replace(/abc/ig, '-') });
    T.push({ method: '.replaceAll()', return: S.replaceAll('c', '-') });

    T.push({ method: '.toUpperCase()', return: S0.toUpperCase() });
    T.push({ method: '.toLowerCase()', return: S0.toLowerCase() });
    T.push({ method: '.toLocaleUpperCase()', return: S0.toLocaleUpperCase() });
    T.push({ method: '.toLocaleLowerCase()', return: S0.toLocaleLowerCase() });
    T.push({ method: '.repeat()', return: S0.repeat(2) });
    T.push({ method: '.concat()', return: S0.concat('d') });

    T.push({ method: '.trim()', return: S0.trim() });
    T.push({ method: '.trimStart()', return: S0.trimStart() });
    T.push({ method: '.trimEnd()', return: S0.trimEnd() });
    T.push({ method: '.padStart()', return: S0.padStart(10, '-') });
    T.push({ method: '.padEnd()', return: S0.padEnd(10, '-') });

    T.push({ method: '.charAt()', return: S0.charAt(1) });
    T.push({ method: '.charCodeAt()', return: S0.charCodeAt(1) });
    T.push({ method: '.codePointAt()', return: S0.codePointAt(1) });
    T.push({ method: '.localeCompare()', return: 'Ã©'.localeCompare('E', 'en-US', optionsString) });

    T.push({ method: '.split()', return: S0.split('', 4) + '' });
    T.push({ method: '[]', return: S0[S0.length - 1] });

    T.push({ method: 'String.fromCharCode()', return: String.fromCharCode(1e5) });
    T.push({ method: 'String.fromCodePoint()', return: String.fromCodePoint(1e5) });
    T.push({ method: 'String.raw``', return: String.raw`\n` });

    C(T);
</script>

<script>
    h('ARRAY METHODS');
    let A = new Array(3);

    A[0] = 'b', A[1] = 'c', A[2] = 'd';
    A = ['a', ...A, 'e',];

    c('.valueOf()\t', A.valueOf(), '\t', A);
    c('.toString()\t', A.toString(), '\t', A);
    c('.join()\t', A.join('-'), '\t', A);
    c('.slice()\t', A.slice(2, 4), '\t', A);
    c('.concat()\t', A.concat('f'), '\t', A);

    c('.splice()\t', A.splice(5, 0, 'f'), '\t', A);
    c('.pop()\t', A.pop(), '\t', A);
    c('.push()\t', A.push('f'), '\t', A);
    c('.shift()\t', A.shift(), '\t', A);
    c('.unshift()\t', A.unshift('a'), '\t', A);

    c('.includes()\t', A.includes('b', 1), '\t', A);
    c('.indexOf()\t', A.indexOf('f', 0), '\t', A);
    c('.lastIndexOf()\t', A.lastIndexOf('f', -2), '\t', A);

    c('.find()\t', A.find((v, i, a) => v > 'c'), '\t', A);
    c('.findLast()\t', A.findLast((v, i, a) => v < 'c'), '\t', A);
    c('.findIndex()\t', A.findIndex((v, i, a) => v > 'c'), '\t', A);
    c('.findLastIndex()\t', A.findLastIndex((v, i, a) => v < 'c'), '\t', A);
    c('.some()\t', A.some((v, i, a) => v === 'c'), '\t', A);
    c('.every()\t', A.every((v, i, a) => v < 'f'), '\t', A);

    c('.forEach()\t', A.forEach((v, i, a) => c('\t', v, '\t', i, '\t', a)), '\t', A);
    c('.filter()\t', A.filter((v, i, a) => v === 'a' || v === 'f'), '\t', A);
    c('.reduce()\t', A.reduce((s, v, i, a) => s + v, 'x'), '\t', A);
    c('.reduceRight()\t', A.reduceRight((s, v, i, a) => s + v, 'x'), '\t', A);
    c('.map()\t', A.map((v, i, a) => v + v), '\t', A);
    c('.flatMap()\t', A.flatMap((v, i, a) => [v, v + v]), '\t', A);

    c('.sort()\t', A.sort((a, b) => a < b ? -1 : 1), '\t', A);
    c('.reverse()\t', A.reverse(), '\t', A);
    c('.copyWithin()\t', A.copyWithin(1, -3, -1), '\t', A);
    c('.fill()\t', A.fill('a', 0, A.length), '\t', A);

    c('.flat()\t', [1, 2, [[[[[3]]]]]].flat(5));
    c('.entries()\t', ['a', 'b'].entries());
    c('.keys()\t', ['a', 'b'].keys());
    c('.values()\t', ['a', 'b'].values());
    c('Array.isArray()\t', Array.isArray(A));
    c('Array.from()\t', Array.from('abc', (v, i) => v));
</script>

<script>
    h('OBJECT METHODS');
    const $prop1 = () => 'prop1';
    const prop1 = undefined;
    let functions = new Object();

    functions = {
        $f() { },
        f: function () { return this.prop2; },
        prop1,
        [$prop1()]: 'one',
    };
    functions['prop2'] = 'two';
    functions = Object.assign({ 'a key': '' }, functions);

    const functions_dup = functions;
    const functionsClone = Object.create(functions);
    functionsClone.prop2 = 'three';
    Object.defineProperty(functionsClone, 'prop2',
        { value: null, writeable: true, enumerable: true, configurable: true });

    c(functionsClone.f());
    c('Object.entries()\t', Object.entries(functions));
    c('Object.keys()\t', Object.keys(functions));
    c('Object.values()\t', Object.values(functions));
    c('Object.hasOwn()\t', Object.hasOwn(functions, 'prop1'));
    c('Object.is()\t', Object.is(functions, functions_dup));
</script>

<script>
    h('LOOPS');
    const array = [true, false, true];
    const objectLiteral = { key_1: 1, key_2: 2, key_3: 3 };
    let total = 0;

    const { key_3: key3, key_2: key2 } = objectLiteral;
    c(`destructuring: ${key2} & ${key3}`);

    for (let index = 15; index >= 10; index -= 2) {
        console.table('index:', index);
    }

    for (const k of array) {
        console.table('array index:', k);
    }

    for (const k in objectLiteral) {
        console.table(k + ': ' + objectLiteral[k]);
    }

    do {
        console.table('unary descending:', --total);
    } while (total >= -2);

    while (total < 0) {
        total++;
        console.table('unary ascending:', total);
        document.write('<h1>' + total + '</h1>');
    }
</script>

<script>
    h('ARROW FUNCTIONS');

    function f1(x = 'output') {
        return 'input: ' + x;
    }

    var f2 = function (x) {
        return 'input: ' + x;
    };

    let f3 = (x) => {
        return 'input: ' + `${x}`;
    };

    const f4 = x => `input: ${x}`;

    console.log(f1());
    console.log(f2('output'));
    console.log(f3('output'));
    console.log(f4('output'));
</script>

<script>
    h('CONSTRUCTORS');

    function Construct(item_1, item_2) {
        this.item_1 = item_1;
        this.item_2 = item_2;
    }
    Construct.prototype.elapsed = function () {
        this.elapsed = new Date().getFullYear() - 2020;
    };
    Construct.prototype.summary = function () {
        return `${this.item_2} & ${this.item_1}`;
    };

    class ConstructDeeper extends Construct {
        constructor(item_1, item_2, item_3) {
            super(item_1, item_2);
            this.item_3 = item_3;
        }
        print() {
            return 'Print';
        }
        static global() {
            return 'Static';
        }
    }

    const construct_1 = new Construct('Thing A', 'Thing B', 'Thing C');
    construct_1.elapsed();
    c(construct_1);

    const construct_2 = new ConstructDeeper('Thing A', 'Thing B', 'Thing C');
    c(construct_2);
    c(construct_2.print());
    c(construct_2.summary());
    c(ConstructDeeper.global());
</script>

<script>
    h('THIS');
    const myObject = {
        arbitrary: 'object',
        logA: function () {
            c(this.arbitrary);
        },
        logB: () => {
            c(this.arbitrary);
        }
    };
    var arbitrary = 'global';

    const case1 = myObject.logA;
    const case2 = myObject.logA.bind(myObject);
    const case3 = myObject.logB;
    const case4 = myObject?.logC ?? 'optional chaining & nullish coalescing';

    c(this);
    myObject.logA();
    case1();
    case2();
    case3();
    c(case4);
</script>

<script>
    h('PROTOTYPE METHODS');

    Array.prototype.customFind = function (callback) {
        for (let i = 0; i < this.length; i++) {
            if (callback(this[i], i, this)) return this[i];
        }
    };

    Array.prototype.customFindIndex = function (callback) {
        for (let i = 0; i < this.length; i++) {
            if (callback(this[i], i, this)) return i;
        }
        return -1;
    };

    console.assert([1, 2, 3].customFind(v => v > 1) === [1, 2, 3].find(v => v > 1));
    console.assert([1, 2, 3].customFindIndex(v => v > 1) === [1, 2, 3].findIndex(v => v > 1));
</script>

<script>
    h('REGULAR EXPRESSIONS');
    const reg = new RegExp('u?v*w{0,}x{2,3}y+z+?(?=0|1|2)', 'g');

    c(/^\d\w\s\*[a-z][^0-9]C.\S\W\D$/im.test('1_ *Abcde \''));
    c(reg.exec('wwxxyyzz1 uvxxxyz2'));
    c(reg.global, reg.ignoreCase, reg.multiline);
    c(reg.source, reg.lastIndex);
    c('wwxxyyzz1 uvxxxyz2'.match(reg));
    c('12!34!56'.match(new RegExp('((\\d+)!(\\d+))!(\\d+)')));
    for (const i of 'A\t\v\0\n\r\f_'.matchAll(/\bA\t\v\0\n\r\f(?!-)/g)) c(i);
</script>

<script>
    h('ASYNCHRONOUS');
    A = [0];

    const add = () => {
        document.body.innerHTML = null;
        A.forEach(v => document.body.innerHTML += `<h1>${v}</h1>`);
    };

    (function ($, cb) { setTimeout(() => { A.push($); cb(); }, 100); })(1, add);

    (function ($, err) {
        return new Promise((res, rej) => {
            setTimeout(() => {
                if (!err) {
                    A.push($);
                    res();
                } else {
                    rej('Error...');
                }
            }, 100);
        });
    })(2, false).then(add);

    (async function ($) {
        await new Promise(res => { setTimeout(() => { A.push($); res(); }, 100); });
        add();
    })(3);

    (function (err = true) {
        return new Promise((res, rej) => {
            if (err) rej('Error...');
        });
    })().catch(c);

    Promise.all([Promise.resolve('Hi'), null, Function, 420, new Promise(res =>
        setTimeout(res, 100, 'Bye'))]).catch().then(c);
</script>

<script>
    setTimeout(() => {
        h('JSON');
        const json = JSON.stringify({ type: true }, (k, v) => v, 4);
        c(json, '\n', JSON.parse(json, (k, v) => v));

        fetch('../documents/json.json')
            .then(res => res.json())
            .then(e => c('.then()\t', e));

        let data;
        (async function () {
            const res = await fetch('../documents/json.json');
            data = await res.json();
            c('async / await\t', data);
        })();

        document.writeln(`<title>JavaScript: ACA</title>
            
            <link rel="stylesheet"
            href="https://cdn.jsdelivr.net/npm/bootstrap/dist/css/bootstrap.min.css">
            <link rel="stylesheet" href="../css/reset.css">
            
            <a>GLOBAL METHODS</a><br><br>
            <a>NUMBER METHODS</a><br><br>
            <a>STRING METHODS</a><br><br>
            <a>ARRAY METHODS</a><br><br>
            <a>OBJECT METHODS</a><br><br>
            <a>LOOPS</a><br><br>
            <a>ARROW FUNCTIONS</a><br><br>
            <a>CONSTRUCTORS</a><br><br>
            <a>THIS</a><br><br>
            <a>PROTOTYPE METHODS</a><br><br>
            <a>ASYNCHRONOUS</a><br><br>
            <a>JSON</a><br><br>`);
    }, 200);
</script>